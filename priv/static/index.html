<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/purecss@1.0.1/build/pure-min.css"
      integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47"
      crossorigin="anonymous"
    />
    <script type="module">
      import {
        h,
        Component,
        render
      } from "https://unpkg.com/preact@latest?module";

      import {
        useState,
        useCallback
      } from "https://unpkg.com/preact@latest/hooks/dist/hooks.module.js?module";

      import htm from "https://unpkg.com/htm?module";

      const rainbow = [
        "#9400d3",
        "#4b0082",
        "#0000ff",
        "#00ff00",
        "#ffff00",
        "#ff7f00",
        "#ff0000",
        "#000000"
      ];

      const html = htm.bind(h);

      function getRainbow() {
        return new Array(8)
          .fill()
          .map((_, i) =>
            new Array(4).fill({ visibile: true, color: rainbow[i] })
          );
      }

      const Row = ({ leds }) =>
        html`
          <div>
            ${leds.map(
              led =>
                html`
                  <${Led} ...${led} />
                `
            )}
          </div>
        `;

      const Led = ({ color }) =>
        html`
          <input type="color" value=${color} />
        `;

      function App() {
        const [grid, setValue] = useState(getRainbow());
        const copyFromOrigin = useCallback(
          () =>
            setValue(
              Array(8)
                .fill()
                .map(() => Array(4).fill(grid[0][0]))
            ),
          [grid]
        );
        const setRainbow = useCallback(() => setValue(getRainbow), [grid]);

        return html`
          ${grid.map(
            row =>
              html`
                <${Row} leds=${row} />
              `
          )}
          <button onClick=${copyFromOrigin}>Copy from 0,0</button>
          <button onClick=${setRainbow}>Rainbow</button>
        `;
      }

      render(
        html`
          <${App} page="All" />
        `,
        document.body
      );
    </script>
  </head>
  <body></body>
</html>
